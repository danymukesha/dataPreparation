<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dataPreparation">
<title>Data Processing Phase 1 Report â€¢ dataPreparation</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Processing Phase 1 Report">
<meta property="og:description" content="dataPreparation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dataPreparation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dataProcessing_phase_1.html">Data Processing Phase 1 Report</a>
    <a class="dropdown-item" href="../articles/dataProcessing_phase_2.html">Data Processing Phase 2 Report</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danymukesha/dataPreparation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data Processing Phase 1 Report</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danymukesha/dataPreparation/blob/HEAD/vignettes/dataProcessing_phase_1.Rmd" class="external-link"><code>vignettes/dataProcessing_phase_1.Rmd</code></a></small>
      <div class="d-none name"><code>dataProcessing_phase_1.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This report outlines the data processing steps involved in phase 1.
It covers various preprocessing tasks such as reformatting material
names, adding missing phenotype data, selecting metadata, deduplication,
imputation of missing values, and performing principal component
analysis (PCA).</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>In this section, we set up the necessary libraries and configurations
for the data processing tasks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danymukesha/dataPreparation" class="external-link">dataPreparation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-loading">Data Loading<a class="anchor" aria-label="anchor" href="#data-loading"></a>
</h3>
<p>We start by loading the raw data from an Excel file containing
normalized data. This data will be used for subsequent preprocessing
steps.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the Excel file containing normalized data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"../inst/extdata/allbatches_uM_clean.txt"</span>, </span>
<span>                   sep <span class="op">=</span> <span class="st">"\t"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reformatting-material-names">Reformatting Material Names<a class="anchor" aria-label="anchor" href="#reformatting-material-names"></a>
</h2>
<p>To ensure consistency and clarity in the material names, I perform
reformatting of material names. This step involves mapping specific
material names to standardized formats.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'20 (serum)'</span> <span class="op">=</span> <span class="st">'serum'</span>,</span>
<span>  <span class="st">'30 (plasma)'</span> <span class="op">=</span> <span class="st">'plasma'</span>,</span>
<span>  <span class="st">'302 (EDTA plasma)'</span> <span class="op">=</span> <span class="st">'plasma'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Material <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Material</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rep_str</span><span class="op">)</span> <span class="op">~</span> <span class="va">rep_str</span><span class="op">[</span><span class="va">Material</span><span class="op">]</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Material</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="processing-sample-identification">Processing Sample.Identification<a class="anchor" aria-label="anchor" href="#processing-sample-identification"></a>
</h2>
<p>I perform then reformatting of Sample names. This step involves
mapping s pecific sample names to standardized formats.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">`Sample.Identification`</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">`Sample.Identification`</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">==</span> <span class="st">"F"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">`Sample.Identification`</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">`Sample.Identification`</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-missing-phenotype-data">Adding Missing Phenotype Data<a class="anchor" aria-label="anchor" href="#adding-missing-phenotype-data"></a>
</h2>
<p>Phenotype data is essential for downstream analysis. In this step, I
add missing phenotype data to the main dataset by merging it with
additional information from external sources.</p>
<p>I developed a function <em>ad-hoc</em>
<code><a href="../reference/add_missing_phenotypes.html">dataPreparation::add_missing_phenotypes</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load additional phenotype information</span></span>
<span><span class="va">all_samples_info</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"../inst/extdata/additional_info.tsv"</span>, </span>
<span>                    sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_samples_info</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">" "</span>, </span>
<span>                                   replacement <span class="op">=</span> <span class="st">"."</span>, </span>
<span>                                   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_samples_info</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">all_samples_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Patient.reference Phenotype Gender Age Plasma-LH    Serum   Plasma-LH</span></span>
<span><span class="co">#&gt; 1    ADIA03FR120087      miAD   Male  74  F1916088 F1916087 F1916088001</span></span>
<span><span class="co">#&gt; 2    ADIA03CH090047      miAD   Male  83           F1915909            </span></span>
<span><span class="co">#&gt; 3    ADIA03CH090046      miAD   Male  81  F1915905 F1915904 F1915905001</span></span>
<span><span class="co">#&gt; 4    ADIA03CH090045      msAD Female  78  F1915900 F1915899 F1915900001</span></span>
<span><span class="co">#&gt; 5    ADIA03CH090044      miAD   Male  76           F1915894            </span></span>
<span><span class="co">#&gt; 6    ADIA03CH090043      miAD Female  67           F1915889            </span></span>
<span><span class="co">#&gt;         Serum Serum       Serum</span></span>
<span><span class="co">#&gt; 1 F1916087001       F1916087012</span></span>
<span><span class="co">#&gt; 2                   F1915909012</span></span>
<span><span class="co">#&gt; 3 F1915904001       F1915904012</span></span>
<span><span class="co">#&gt; 4 F1915899001       F1915899010</span></span>
<span><span class="co">#&gt; 5                   F1915894011</span></span>
<span><span class="co">#&gt; 6                   F1915889012</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add missing phenotype information</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dataPreparation</span><span class="fu">::</span><span class="fu"><a href="../reference/add_missing_phenotypes.html">add_missing_phenotypes</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">all_samples_info</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">Gender</span>, </span>
<span>                  <span class="va">Age</span>, </span>
<span>                  .before <span class="op">=</span> <span class="va">Sample.Description</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="selecting-metadata">Selecting Metadata<a class="anchor" aria-label="anchor" href="#selecting-metadata"></a>
</h2>
<p>Metadata selection involves choosing relevant columns from the
dataset that provide information about each sample. These metadata
columns are crucial for sample identification and downstream
analysis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select metadata</span></span>
<span><span class="va">allmetadata</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sample.Identification"</span>, </span>
<span>                       <span class="st">"Sample.Type"</span>, </span>
<span>                       <span class="st">"Sample.Description"</span>, </span>
<span>                       <span class="st">"Gender"</span>, </span>
<span>                       <span class="st">"Age"</span>, </span>
<span>                       <span class="st">"Material"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">allmetadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">allmetadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter metadata for samples</span></span>
<span><span class="va">allmetadata</span> <span class="op">&lt;-</span> <span class="va">allmetadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Sample.Type</span> <span class="op">==</span> <span class="st">"Sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter data for samples</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Sample.Type</span> <span class="op">==</span> <span class="st">"Sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove temporary objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allmetadata"</span>, </span>
<span>                          <span class="st">"data"</span>, </span>
<span>                          <span class="st">"add_missing_phenotypes"</span>, </span>
<span>                          <span class="st">"fncols"</span>,  </span>
<span>                          <span class="st">"all_samples_info"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html" class="external-link">as.tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please use `as_tibble()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> The signature and semantics have changed, see `?as_tibble`.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 416</span></span></span>
<span><span class="co">#&gt;   Sample.Type Sample.Identification Gender   Age Sample.Description</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Sample      F1800067              Female    93 DLB               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Sample      F1701006              Male      68 DLB               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Sample      F1915899              Female    78 msAD              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Sample      F1912538              Male      63 msAD              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Sample      F1815069              Male      83 miAD              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Sample      F1705317              Female    78 miAD              </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 411 more variables: Submission.Name &lt;chr&gt;, Material &lt;chr&gt;, AC.0.0. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.2.0. &lt;dbl&gt;, AC.3.0. &lt;dbl&gt;, AC.3.0.DC. &lt;dbl&gt;, AC.3.0.OH. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.3.1. &lt;dbl&gt;, AC.4.0. &lt;dbl&gt;, AC.4.0.DC. &lt;dbl&gt;, AC.4.0.OH. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.4.1. &lt;dbl&gt;, AC.4.1.DC. &lt;dbl&gt;, AC.5.0. &lt;dbl&gt;, AC.5.0.DC. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.5.0.OH. &lt;dbl&gt;, AC.5.1. &lt;dbl&gt;, AC.5.1.DC. &lt;dbl&gt;, AC.6.0. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.6.0.DC. &lt;dbl&gt;, AC.6.0.OH. &lt;dbl&gt;, AC.6.1. &lt;dbl&gt;, AC.7.0. &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AC.7.0.DC. &lt;dbl&gt;, AC.8.0. &lt;dbl&gt;, AC.8.1. &lt;dbl&gt;, AC.8.1.OH. &lt;dbl&gt;, â€¦</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-metadata-and-data">Writing Metadata and Data<a class="anchor" aria-label="anchor" href="#writing-metadata-and-data"></a>
</h2>
<p>After selecting the metadata and preparing the dataset, I write the
metadata and cleaned data into separate CSV files for future reference
and analysis.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Write metadata to a CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">allmetadata</span>, file <span class="op">=</span> <span class="st">"../inst/data_to_use/all_metadata.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write data to a CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">data</span>, file <span class="op">=</span> <span class="st">"../inst/data_to_use/all_batches.csv"</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span>, quote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="deduplication">Deduplication<a class="anchor" aria-label="anchor" href="#deduplication"></a>
</h2>
<p>Deduplication is necessary to handle cases where multiple entries for
the same sample exist. I aggregate duplicated rows by calculating the
mean of numeric columns and assigning a common submission name.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the aggregate function to calculate the mean for duplicated rows</span></span>
<span><span class="co"># Merge the data by taking the mean of numeric columns and assigning the Submission.Name as "Plate 1-2"</span></span>
<span><span class="va">df_deduplicated</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Sample.Identification</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>            Submission.Name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span>, <span class="st">"Plate 1-2"</span>, <span class="va">Submission.Name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            Sample.Description <span class="op">=</span> <span class="va">Sample.Description</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            Material <span class="op">=</span> <span class="va">Material</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            Sample.Type <span class="op">=</span> <span class="va">Sample.Type</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            Gender <span class="op">=</span> <span class="va">Gender</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">df_deduplicated</span> <span class="op">&lt;-</span> <span class="va">df_deduplicated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">Sample.Type</span>, </span>
<span>                                                <span class="va">Sample.Description</span>, </span>
<span>                                                <span class="va">Gender</span>, </span>
<span>                                                <span class="va">Age</span>, </span>
<span>                                                <span class="va">Material</span>, </span>
<span>                                                <span class="va">Submission.Name</span>,</span>
<span>                                                .after <span class="op">=</span> <span class="va">Sample.Identification</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta_deduplicated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">allmetadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge metadata and raw_data using a common key</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">df_deduplicated</span></span>
<span></span>
<span><span class="co"># Remove temporary objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"allmetadata"</span>,</span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"add_missing_phenotypes"</span>,</span>
<span>    <span class="st">"fncols"</span>,</span>
<span>    <span class="st">"combined_data"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-cohort-information">Adding Cohort Information<a class="anchor" aria-label="anchor" href="#adding-cohort-information"></a>
</h2>
<p>Cohort information provides context about the sample population.
Here, I add cohort information based on the sample description,
distinguishing between different cohorts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data</span><span class="op">$</span><span class="va">Cohort</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">combined_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"AD"</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span></span>
<span>                       <span class="va">combined_data</span><span class="op">$</span><span class="va">Sample.Description</span>,</span>
<span>                       start <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       stop <span class="op">=</span> <span class="fl">5</span></span>
<span>                     <span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">Cohort</span> <span class="op">&lt;-</span> <span class="st">"AD"</span></span>
<span><span class="va">combined_data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"AD"</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span></span>
<span>                        <span class="va">combined_data</span><span class="op">$</span><span class="va">Sample.Description</span>,</span>
<span>                        start <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                        stop <span class="op">=</span> <span class="fl">5</span></span>
<span>                      <span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">Cohort</span> <span class="op">&lt;-</span></span>
<span><span class="va">combined_data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"AD"</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span></span>
<span>                        <span class="va">combined_data</span><span class="op">$</span><span class="va">Sample.Description</span>,</span>
<span>                        start <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                        stop <span class="op">=</span> <span class="fl">5</span></span>
<span>                      <span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">Sample.Description</span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">Cohort</span>, .after <span class="op">=</span> <span class="va">Sample.Description</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">combined_data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"sampleID"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">combined_data</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Allgr"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-combined-data">Writing Combined Data<a class="anchor" aria-label="anchor" href="#writing-combined-data"></a>
</h2>
<p>After deduplication and cohort assignment, I write the combined and
processed data into a CSV file for further analysis.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write.csv(x = combined_data, file = "../inst/data_to_use/CLEAN_combined_data_allbatches.csv", row.names = FALSE)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preprocessing-data">Preprocessing Data<a class="anchor" aria-label="anchor" href="#preprocessing-data"></a>
</h2>
<p>In this step, I preprocess the data by removing columns with high
missingness and imputing missing values using the k-nearest neighbors
(knn) algorithm.</p>
<p>I developed a function ad-hoc
<code><a href="../reference/remove_high_missingness.html">dataPreparation::remove_high_missingness</a></code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the raw data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove rows with high missingness and impute missing values with k-nearest neighbors (knn)</span></span>
<span><span class="va">elaborated_data</span> <span class="op">&lt;-</span> <span class="fu">dataPreparation</span><span class="fu">::</span><span class="fu"><a href="../reference/remove_high_missingness.html">remove_high_missingness</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Columns removed due to more than 10 % missing values:</span></span>
<span><span class="co">#&gt; AC.4.0. : 14.59459 % missing</span></span>
<span><span class="co">#&gt; AC.4.0.DC. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.4.1. : 14.59459 % missing</span></span>
<span><span class="co">#&gt; AC.4.1.DC. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.5.0.DC. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.5.0.OH. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.5.1.DC. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.6.0. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.6.0.DC. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.6.1. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; AC.7.0. : 12.97297 % missing</span></span>
<span><span class="co">#&gt; Ile : 25.40541 % missing</span></span>
<span><span class="co">#&gt; xLeu : 41.08108 % missing</span></span>
<span><span class="co">#&gt; PEA : 25.94595 % missing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rows removed due to more than 10 % missing values:</span></span>
<span><span class="co">#&gt; Row 153 : 79.4621 % missing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns removed due to having  0  variance:</span></span>
<span><span class="co">#&gt; Carnosine  </span></span>
<span><span class="co">#&gt; LPC.9.0.  </span></span>
<span><span class="co">#&gt; PC.30.2.  </span></span>
<span><span class="co">#&gt; PC.O.31.1.  </span></span>
<span><span class="co">#&gt; PC.O.33.4.  </span></span>
<span><span class="co">#&gt; PC.O.38.1.  </span></span>
<span><span class="co">#&gt; PC.O.44.3.</span></span>
<span><span class="va">imputed_data</span> <span class="op">&lt;-</span> <span class="va">elaborated_data</span><span class="op">$</span><span class="va">cleaned_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">impute</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/impute/man/impute.knn.html" class="external-link">impute.knn</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select categories</span></span>
<span><span class="va">categories</span> <span class="op">&lt;-</span> <span class="va">combined_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">elaborated_data</span><span class="op">$</span><span class="va">row_missing_percent</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample.Description</span>, <span class="va">Submission.Name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add categories to imputed data</span></span>
<span><span class="va">imputed_data</span><span class="op">$</span><span class="va">categories</span> <span class="op">&lt;-</span> <span class="va">categories</span></span>
<span></span>
<span><span class="co"># Remove temporary objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"allmetadata"</span>,</span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"add_missing_phenotypes"</span>,</span>
<span>    <span class="st">"fncols"</span>,</span>
<span>    <span class="st">"combined_data"</span>,</span>
<span>    <span class="st">"elaborated_data"</span>,</span>
<span>    <span class="st">"imputed_data"</span>,</span>
<span>    <span class="st">"remove_high_missingness"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-imputed-data">Writing imputed data<a class="anchor" aria-label="anchor" href="#writing-imputed-data"></a>
</h2>
<p>Here, I save data where rows with high missingness were removed and
impute missing values with k-nearest neighbors (knn).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">combined_data</span>, file <span class="op">=</span> <span class="st">"../inst/data_to_use/imputed_data_allbatches.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">imputed_data</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Setting active project to <span style="color: #0000BB;">'C:/08_pkgs/dataPreparation'</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> Saving <span style="color: #0000BB;">'imputed_data'</span> to <span style="color: #0000BB;">'data/imputed_data.rda'</span></span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">â€¢</span> Document your data (see <span style="color: #0000BB;">'https://r-pkgs.org/data.html'</span>)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performing-principal-component-analysis-pca">Performing Principal Component Analysis (PCA)<a class="anchor" aria-label="anchor" href="#performing-principal-component-analysis-pca"></a>
</h2>
<p>Principal Component Analysis (PCA) is a dimensionality reduction
technique that helps visualize the variation in the dataset. Here, I
perform PCA on the preprocessed data and create a PCA plot for
visualization.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform PCA</span></span>
<span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">imputed_data</span><span class="op">$</span><span class="va">data</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract PCA scores</span></span>
<span><span class="va">pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine PCA scores with categories for visualization</span></span>
<span><span class="va">pca_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pca_scores</span>, <span class="va">imputed_data</span><span class="op">$</span><span class="va">categories</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create PCA plot</span></span>
<span><span class="va">pca_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pca_data</span>, </span>
<span>                            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, </span>
<span>                                         color <span class="op">=</span> <span class="va">Submission.Name</span>, </span>
<span>                                         shape <span class="op">=</span> <span class="va">Sample.Description</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"PCA Plot"</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>        <span class="st">"PC1 (Explained Variance: "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">sdev</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">sdev</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        <span class="st">"%)"</span></span>
<span>      <span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>        <span class="st">"PC2 (Explained Variance: "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">sdev</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca_result</span><span class="op">$</span><span class="va">sdev</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        <span class="st">"%)"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display PCA plot</span></span>
<span><span class="va">pca_plot</span></span></code></pre></div>
<p><img src="dataProcessing_phase_1_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"../man/figures/pca_plot.png"</span>, width<span class="op">=</span><span class="fl">1600</span>, height<span class="op">=</span><span class="fl">1200</span>, res<span class="op">=</span><span class="fl">220</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pca_plot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dany Mukesha.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
